# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ—Ç–ª–∞–¥–∫–µ –æ–Ω–ª–∞–π–Ω –¥–æ—Å–∫–∏

## üö® –ï—Å–ª–∏ —Ç–æ—á–∫–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

### –®–∞–≥ 1: –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É üî¨ **"–ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã"** –≤ –ø–∞–Ω–µ–ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
3. –ò–∑—É—á–∏—Ç–µ –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª–∏

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ
–í –∫–æ–Ω—Å–æ–ª–∏ –≤—ã —É–≤–∏–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª "–î–∞–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã":
- –ï—Å–ª–∏ `–û–ø–µ—Ä–∞—Ü–∏–π –≤ –ë–î: 0` - —Ç–æ—á–µ–∫ –Ω–µ—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ï—Å–ª–∏ –µ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏, –Ω–æ –æ–Ω–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è - –ø—Ä–æ–±–ª–µ–º–∞ –≤ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏

### –®–∞–≥ 3: –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ —Å–µ—Å—Å–∏—é
1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É üîÑ **"–ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é"**
2. –î–æ–∂–¥–∏—Ç–µ—Å—å —Å–æ–æ–±—â–µ–Ω–∏—è "–°–µ—Å—Å–∏—è –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ"
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –ø–æ—è–≤–∏–ª–∏—Å—å –ª–∏ —Ç–æ—á–∫–∏

### –®–∞–≥ 4: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
1. –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –Ω–∞ –∫–Ω–æ–ø–∫–µ üîÑ **"–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ"**
2. –ò–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏: `window.forceRestoreWithLogging()`
3. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º –≤ –∫–æ–Ω—Å–æ–ª–∏

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –ö–Ω–æ–ø–∫–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:
- üêõ **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è** - –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–æ—Å–∫–∏
- üî¨ **–ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** - –ø–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- üîÑ **–ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é** - –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏ —É—Ä–æ–∫–∞
- üîÑ **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ** - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ—á–µ–∫ (–¥–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ)

### –§—É–Ω–∫—Ü–∏–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏:
```javascript
// –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
window.fullSystemDiagnostic()

// –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
window.diagnoseBoardRestoration()

// –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏
window.recreateSession()

// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
window.forceRestoreWithLogging()

// –ü—Ä–æ–≤–µ—Ä–∫–∞ WebSocket
window.checkWebSocketConnection()

// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
window.forceBoardSync()
```

## üìä –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏

### 1. –î–∞–Ω–Ω—ã–µ —É—Ä–æ–∫–∞
```
üìö –î–∞–Ω–Ω—ã–µ —É—Ä–æ–∫–∞:
  - lessonData: true
  - ID: 123
  - –°–µ—Å—Å–∏—è: –µ—Å—Ç—å
    - Room ID: room_123
```

### 2. Canvas —Å–æ—Å—Ç–æ—è–Ω–∏–µ
```
üé® Canvas —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
  - Canvas —ç–ª–µ–º–µ–Ω—Ç: true
  - Context: true
  - –†–∞–∑–º–µ—Ä—ã: 10000x10000
  - –í–∏–¥–∏–º—ã–π: true
```

### 3. WebSocket —Å–æ—Å—Ç–æ—è–Ω–∏–µ
```
üîå WebSocket —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
  - isConnected: true
  - stompClient: true
  - stompClient.connected: true
```

### 4. –î–∞–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã
```
üóÑÔ∏è –î–∞–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã:
  - –£—Å–ø–µ—à–Ω–æ: true
  - –û–ø–µ—Ä–∞—Ü–∏–π –≤ –ë–î: 150
  - –ü–µ—Ä–≤—ã–µ 3 –æ–ø–µ—Ä–∞—Ü–∏–∏:
    1. draw –≤ (100, 200) —Ü–≤–µ—Ç: #000000
    2. draw –≤ (101, 201) —Ü–≤–µ—Ç: #000000
    3. draw –≤ (102, 202) —Ü–≤–µ—Ç: #000000
```

## üõ†Ô∏è –†–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "–û–ø–µ—Ä–∞—Ü–∏–π –≤ –ë–î: 0"
**–†–µ—à–µ–Ω–∏–µ:** –¢–æ—á–∫–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ WebSocket
2. –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ª–∏ –¥–∞–Ω–Ω—ã–µ —Ä–∏—Å–æ–≤–∞–Ω–∏—è
3. –ï—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–∏ —Ä–∏—Å–æ–≤–∞–Ω–∏–∏

### –ü—Ä–æ–±–ª–µ–º–∞: "Canvas —ç–ª–µ–º–µ–Ω—Ç: false"
**–†–µ—à–µ–Ω–∏–µ:** Canvas –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –ó–∞–≥—Ä—É–∑–∏–ª—Å—è –ª–∏ HTML –ø–æ–ª–Ω–æ—Å—Ç—å—é
2. –ï—Å—Ç—å –ª–∏ —ç–ª–µ–º–µ–Ω—Ç —Å id="boardCanvas"
3. –ù–µ—Ç –ª–∏ –æ—à–∏–±–æ–∫ JavaScript

### –ü—Ä–æ–±–ª–µ–º–∞: "WebSocket –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è"
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:
1. –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é (–∫–Ω–æ–ø–∫–∞ üîÑ)
2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞: "–û–ø–µ—Ä–∞—Ü–∏–∏ –µ—Å—Ç—å, –Ω–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è"
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–±–ª–µ–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:
1. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ (–¥–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –Ω–∞ üîÑ)
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ –∫–æ–Ω—Å–æ–ª–∏
3. –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é

## üìù –õ–æ–≥–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

–ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–æ—á–µ–∫ –≤—ã —É–≤–∏–¥–∏—Ç–µ:
```
üîÑ === –ù–ê–ß–ê–õ–û –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–Ø –î–û–°–ö–ò ===
üìä –†–∞–∑–º–µ—Ä boardState: 150
üé® Canvas —Ä–∞–∑–º–µ—Ä—ã: 10000 x 10000
üßπ –î–æ—Å–∫–∞ –æ—á–∏—â–µ–Ω–∞
üìà –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º 150 –æ–ø–µ—Ä–∞—Ü–∏–π —Ä–∏—Å–æ–≤–∞–Ω–∏—è
üìã –û–ø–µ—Ä–∞—Ü–∏–∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ sequenceNumber
üìä –ü—Ä–æ–≥—Ä–µ—Å—Å: 100/150 (67%)
üìç –¢–æ—á–∫–∞ #100: draw –≤ (150, 250) —Ü–≤–µ—Ç: #000000 —Ä–∞–∑–º–µ—Ä: 3
‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ: 150 –≤–∞–ª–∏–¥–Ω—ã—Ö, 0 –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∑–∞ 45ms
üìç –í—Å–µ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Ç–æ—á–µ–∫: 150
üéâ === –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –î–û–°–ö–ò –ó–ê–í–ï–†–®–ï–ù–û ===
```

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è:
1. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏
2. ‚úÖ –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–æ—Å–∫–∏
3. ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ WebSocket
4. ‚úÖ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã (fallback)
5. ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥

## üìû –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç

1. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ª–æ–≥–∏ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ API: `fetch('/api/board/state/{lessonId}')`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –µ—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∏ –≤ Network –≤–∫–ª–∞–¥–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É —Å –ø–æ–ª–Ω—ã–º–∏ –ª–æ–≥–∞–º–∏
